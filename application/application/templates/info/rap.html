{% extends "base.html" %}
{% block content %}

<div class="row">
  <div class="span8 offset2">
    <div class="centered">
      <h1>{{ rap.title }}</h1>
    </div>
    <div class="row">
      <div class="span4">
        <h3>Accepted Lines</h3>
        {% for line in accepted_lines %}
          <div class="line-container">
            <div class="votes" id="{{ line.id}}">
              {{ line.line1 }}<br/>
              {{ line.line2 }}<br/>
            </div>
          </div>
        {% endfor %}
      </div>
      <div class="span4">
        <h3>Pending Lines</h3>
        {% for line in pending_lines %}
          <div class="line-container">
            <div class="votes" id="number{{line.id}}">
              {{ line.line1 }}<br/>
              {{ line.line2 }}<br/>
              <em> Submitted by <a href="/user/{{ line_users[loop.index0][1] }}">{{ line_users[loop.index0][0] }}</a> 
              (<span class="up_count">{{ line.upvotes }}</span>, <span class="down_count">{{ line.downvotes }}</span>)</em>
              {% if user %}
                {% if already_voted[loop.index0] %}
              <i class="icon-arrow-up up voted"></i>
              <i class="icon-arrow-down down voted"></i>
                {% else %}
              <i class="icon-arrow-up up"></i>
              <i class="icon-arrow-down down"></i>
                {% endif %}
              {% endif %}
              <br/>
            </div>
          </div>
        {% endfor %}    
        <hr>
        {% if user %}
        <form method="post" action="/add_line">
          <fieldset>
            <h4>Submit your own line</h4>
            <input type="hidden" value="{{ rap.id }}" name='rapID'><br>
            <input type="text" placeholder="Line 1" name='line1'><br>
            <input type="text" placeholder="Line 2" name='line2'><br>
            <button type="submit" class="btn">Submit</button>
          </fieldset>
        </form>
        {% endif %}
      </div>
    </div>
  </div>
</div>

{% endblock %}
{% block js %}
  <script>
    $(document).ready(rapView.init);
  </script>
{% endblock %}
